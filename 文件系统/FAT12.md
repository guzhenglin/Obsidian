## **FAT12**

第一个扇区为逻辑0扇区，共512字节，最后两个字节内容为55AA。即(0xAA55，低字节在前，高字节在后) BIOS启动时读取这个扇区，然后继续执行指令，达到引导系统的目的，这个磁盘称为引导磁盘

### 0扇区有固定的数据结构，对应数据如下：

0～2 短跳转指令 .<. 
3～10 厂商名 mkfs.fat 创建映像的命令 
11～12 每扇区字节数 0x0200 512 
13 每簇扇区数 0x04 4 
14~15 Boot记录占用扇区 0x0001 1 
16 FAT表数量 0x02 2 
17～18 根目录文件最大数 0x0200 512=32扇区 
19~20 扇区总数 0x1000 4096 
21 介质描述符 0xf8 248 
22～23 每个FAT表所占扇区数 0x0003 3 
24～25 每磁道扇区数 0x0020 32 
26～27 磁头数/面数 0x0040 64 
28～31 隐藏扇区数 0 
32～35 另一扇区数 0 
36 INT 13H的驱动器号 0x80 128 
37 保留，未使用 0 
38 拓展引导标记(29h) 0x29 
39~42 卷序列号 0x00f43731 
43～53 卷标 NO NAME 
54~61 文件系统类型 FAT12 
62～509 引导代码及其他数据 
510～511 结束标志 0xAA55

### FAT表

每个FAT表占用3个扇区 FAT1占用1～3扇区，FAT2占用4～6扇区 每个可用族在FAT有一个可用项，对应簇号内填入“表项值”来表明簇的属性。 FAT12文件系统每个FAT项占1.5个字节，长度12bit。 簇号含义：

> 0xff8:当前簇是本文件的最后一个簇 0xff7:坏簇 0x000:可用簇 在FAT12文件系统中，每个簇号占1.5个字节。由于采用小端序，簇号的读取方式为 01 23 45：前一簇：301，后一簇452。

### 根目录区

开始扇区7,从0xe00开始 根目录长度不固定，每个条目占32个字节 每个条目的结构如下： 0～7 文件名 8～10 拓展名 11 文件属性 00：普通文件 01：只读 02：隐藏 04：系统文件 10：目录文件 12～21 保留位 22～23 最后一次写入时间 0x58eb 22763 转换为二进制16位，高5位小时，次6位分钟，低5位秒的1/2,加毫秒的进位1

0101 1000 1110 1011 ：11:07:23

24～25 最后一次写入日期 0x5549 21833 转换为二进制16位，高7位+1980年数，次4位月份，低5位日期

0101 0101 0100 1001：2022.10.9

26～27 此条目对应的开始簇数 0x0006 28～31 文件大小 0x001b91f3 1806835 1.8M

### 数据区

数据区开始簇号为2。每簇4个扇区，每个扇区512字节，因此每簇读取2048个字节。 读出当前数据后，根据FAT表项的内容跳转至下一簇或结束读取。